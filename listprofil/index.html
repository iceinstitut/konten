
<html>
  <head>
    <title>Form Profil Pengembang</title>
    <script src="../load-components.js"></script>
    <script src="../load-head.js"></script>
    <script src="../load-components.js"></script>
  <style>
    .placeholder-card {
      height: 220px;
      border: 1px solid #dee2e6;
      border-radius: 0.5rem;
      background-color: #f8f9fa;
      animation: pulse 1.5s infinite;
    }
    @keyframes pulse {
      0% { background-color: #f8f9fa; }
      50% { background-color: #e9ecef; }
      100% { background-color: #f8f9fa; }
    }
  </style>
  
  
  </head>
  <body>
    <div id="header"></div>

    <main class="container py-3">
    
    <h2 class="text-center mb-4">Daftar Course dan Pengembang di ICE Institute</h2>

    <div class="mb-3">
      <input type="text" id="searchInput" class="form-control" placeholder="Cari course, dosen, atau institusi...">
    </div>

    <div class="mb-2 text-end text-muted" id="dataInfo"></div>

    <div id="cardContainer" class="row g-4">
      
    </div>

    <nav class="mt-4">
      <ul class="pagination justify-content-center" id="pagination"></ul>
    </nav>


    </main>

    <div id="footer"></div>

    <script>
    const apiUrl = "https://script.google.com/macros/s/AKfycbxSjfZh82J_TERGOgVpoxBJ4qqpeoDc-uQGec1Wz643V0IRwPgea_wfb5Bn3rAYcZ4x/exec"; // Ganti dengan URL JSON kamu
    let allData = [];
    let filteredData = [];
    const itemsPerPage = 12;
    let currentPage = 1;

    async function fetchData() {
      try {
        const res = await fetch(apiUrl);
        const data = await res.json();
        allData = data;
        filteredData = [...allData];
        renderPage(1);
      } catch (err) {
        const container = document.getElementById("cardContainer");
        container.innerHTML = "<p class='text-danger'>Gagal memuat data.</p>";
        console.error(err);
      }
    }

    function renderPage(page) {
      currentPage = page;
      const start = (page - 1) * itemsPerPage;
      const end = start + itemsPerPage;
      const pageItems = filteredData.slice(start, end);

      const container = document.getElementById("cardContainer");
      container.innerHTML = pageItems.map(item => `
        <div class="col-md-6 col-lg-4">
          <div class="card h-100 shadow-sm">
            <div class="card-body">
              <h5 class="card-title">${item.nama_mk}</h5>
              <p class="card-text"><strong>Kode:</strong> ${item.kode_mk}</p>
              <p class="card-text"><strong>Partner:</strong> ${item.Partner}</p>
              <p class="card-text"><strong>Dosen:</strong> ${item.nama_dosen}</p>
              <p class="card-text"><strong>Institusi:</strong> ${item.institusi_dosen}</p>
            </div>
          </div>
        </div>
      `).join("");

      renderPagination();
      updateDataInfo(start, end, filteredData.length);
    }

    function renderPagination() {
      const totalPages = Math.ceil(filteredData.length / itemsPerPage);
      const pagination = document.getElementById("pagination");
      pagination.innerHTML = "";

      const prevDisabled = currentPage === 1 ? "disabled" : "";
      const nextDisabled = currentPage === totalPages ? "disabled" : "";

      pagination.innerHTML += `
        <li class="page-item ${prevDisabled}">
          <a class="page-link" href="#" onclick="renderPage(${currentPage - 1})">Sebelumnya</a>
        </li>
      `;

      pagination.innerHTML += `
        <li class="page-item disabled">
          <a class="page-link" href="#">${currentPage} / ${totalPages}</a>
        </li>
      `;

      pagination.innerHTML += `
        <li class="page-item ${nextDisabled}">
          <a class="page-link" href="#" onclick="renderPage(${currentPage + 1})">Berikutnya</a>
        </li>
      `;
    }

    function updateDataInfo(start, end, total) {
      const shownEnd = Math.min(end, total);
      document.getElementById("dataInfo").textContent = `Menampilkan ${start + 1} - ${shownEnd} dari ${total} data`;
    }

    document.getElementById("searchInput").addEventListener("input", (e) => {
      const keyword = e.target.value.toLowerCase();
      filteredData = allData.filter(item =>
        item.nama_mk.toLowerCase().includes(keyword) ||
        item.kode_mk.toLowerCase().includes(keyword) ||
        item.Partner.toLowerCase().includes(keyword) ||
        item.nama_dosen.toLowerCase().includes(keyword) ||
        item.institusi_dosen.toLowerCase().includes(keyword)
      );
      renderPage(1);
    });

    // Tampilkan placeholder sebelum fetch
    document.addEventListener("DOMContentLoaded", () => {
      const container = document.getElementById("cardContainer");
      container.innerHTML = Array.from({ length: 12 }).map(() => `
        <div class="col-md-6 col-lg-4">
          <div class="placeholder-card p-3"></div>
        </div>
      `).join("");
      fetchData();
    });
  </script>
  </body>
</html>
